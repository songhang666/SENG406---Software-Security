{
  "version": "2.4.1",
  "summary": {
    "title": "ShareNote",
    "owner": "George",
    "description": "The system under study is a web-based collaborative note-taking app, called ShareNote. The app allows users to\ncreate notes, and share them so others can either read or edit notes, depending on permissions set by the creator\nof the note. Users can also comment on notes.\n\nSystem Overview \n\nShareNote allows users to: \n\nCreate and edit notes containing text, images, hyperlinks, and internal note references. \n\nShare notes via secret links (with read/edit permissions) or make them publicly readable. \n\nComment on shared notes (text-only). \n\nManage access controls (creator can delete comments, restrict editing). \n\nKey Components \n\nFrontend: Web interface (HTTPS, accessible on desktop/mobile). \n\nBackend: On-premises server (firewall-protected, reverse proxy). \n\nDatabase: On-premises, not directly internet-accessible. \n",
    "id": 0
  },
  "detail": {
    "contributors": [
      {
        "name": "Yue"
      },
      {
        "name": "xiayi"
      }
    ],
    "diagrams": [
      {
        "id": 0,
        "title": "ShareNote STRIDE diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": -110,
              "y": 165
            },
            "size": {
              "width": 230,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Logged-in User"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f96bd35c-2650-4e14-9ce4-ccf1ad007ab5"
                },
                {
                  "group": "right",
                  "id": "deb5eb68-d1a8-4ceb-b7fb-be279e558fd2"
                },
                {
                  "group": "bottom",
                  "id": "05967aeb-1e31-484f-9416-7b59c21dfadc"
                },
                {
                  "group": "left",
                  "id": "d32de175-0c3a-41f1-8df0-0b5ea3863938"
                }
              ]
            },
            "id": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
            "data": {
              "type": "tm.Actor",
              "name": "Logged-in User",
              "description": "Logged-in users are registered users who have successfully authenticated into the ShareNote system. They can view notes they have access to, create new notes, and share their notes with other users either publicly or through private share links. Additionally, they can comment on notes they have permission to access.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "850df8af-996e-40ba-a465-39c9bfeb5cf8",
                  "title": "User identity spoofing. Credential too weak or stolen",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Credentials of user can be stolen or guessed. Attacker may impersonate users to gain access to notes\t\n",
                  "mitigation": "Enforce strong authentication, session management.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": ""
                },
                {
                  "id": "7a4ba7fa-74a1-4714-8c3f-51ef7ce9fb0d",
                  "title": "Repudiation of Performed Actions",
                  "status": "Open",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "A logged-in user might deny having performed an action, such as editing a note or sharing it, making it difficult to hold them accountable.",
                  "mitigation": "- Maintain tamper-proof audit logs\n- Include timestamps and user IDs in logs\n- Digitally sign critical transactions or records\n- Restrict access to log modification",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": ""
                },
                {
                  "id": "09e56541-901b-4b4b-b28e-aa23dbf55fbb",
                  "title": "Impersonation of Another User",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Repudiation",
                  "description": "A user may attempt to masquerade as another user by guessing session tokens, forging cookies, or manipulating request headers.",
                  "mitigation": "- Enforce strong session management\n- Validate authentication tokens\n- Reject requests without valid credentials",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 37,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 6,
                "repudiation": 6
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "create request",
              "description": "The request data sent by a user to the system when creating a note.\ncreate request data contains:\n* userld: String\n* title: String\n* content: Content",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "9490699a-f8d3-4e19-b8a6-4145648221aa",
                  "title": "Bypass permission checks",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "Access or edit notes without authorization",
                  "mitigation": "Enforce strict backend authorization, validate every action against role",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": ""
                },
                {
                  "id": "2c8c7215-8d8d-48be-9f73-a696798a67ea",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 115,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "create request"
            ],
            "id": "5a1d427e-4167-4216-8dc1-9fca8835afad",
            "source": {
              "cell": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
              "port": "deb5eb68-d1a8-4ceb-b7fb-be279e558fd2"
            },
            "target": {
              "cell": "67257914-5a7f-48b2-a6e1-0a69bf9359c9",
              "port": "41637cef-6c49-4d3a-8d74-db63f6180532"
            },
            "vertices": [
              {
                "x": 390,
                "y": 120
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "modification request",
              "description": "The request data sent by an admin to the system when modifying system data.\nmodification request data contains:\n* admin credentials\n* operation data",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "c94d572e-d25c-449f-b6e6-a1774d3c183d",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 87,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "modification request"
            ],
            "id": "6d91212a-569b-4d69-bc27-7cf9add8803a",
            "source": {
              "cell": "8f4422f4-718e-4a9e-bef8-1b8905e7b889",
              "port": "b8ac6174-c65c-4e67-ab88-936f9c38b1aa"
            },
            "target": {
              "cell": "bd26356a-c0a6-4c58-8c0e-5aaaadb95c54",
              "port": "7a852e9b-0701-447a-a875-6e4318343331"
            },
            "vertices": [
              {
                "x": 1080,
                "y": 640
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "database operation",
              "description": "database operation data contains database operation commands",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "bceddb06-20b2-4233-8fad-cc8000f1a64b",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 89,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "database operation"
            ],
            "id": "a123e6b7-a5d1-4365-baf8-2638ac6fad71",
            "source": {
              "cell": "bd26356a-c0a6-4c58-8c0e-5aaaadb95c54",
              "port": "8e699b55-bd42-464f-b280-274589ac26e8"
            },
            "target": {
              "cell": "fffd7ccf-dcc6-4a5b-822d-9e4fbcd334bd",
              "port": "a4fdfdba-00c2-4d88-8273-d7a7c6598fc9"
            },
            "vertices": [
              {
                "x": 1260,
                "y": 540
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "system modification",
              "description": "The modification data sent by system to a user when a related modification is completed by an admin.\nsystem modification data contains:\n* the data returned by the system and displayed on the user interface, can be note data, comment data, SharedNote data",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "87040b5e-bdc6-4686-96a3-060a584f866a",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 81,
                  "score": ""
                },
                {
                  "id": "7f27c57f-5dda-4b58-a621-2ae8a9c72525",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 121,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "system modification"
            ],
            "id": "615ff348-ba30-4355-b3a1-84fee829f169",
            "source": {
              "cell": "bd26356a-c0a6-4c58-8c0e-5aaaadb95c54",
              "port": "cc567b8b-1d87-4e94-be27-b80f4eddac10"
            },
            "target": {
              "cell": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
              "port": "05967aeb-1e31-484f-9416-7b59c21dfadc"
            },
            "vertices": [
              {
                "x": 350,
                "y": 630
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note data",
              "description": "The data sent by the system to the content database when the system is trying to store an note's content data.\nnote data contains:\n* note: Note (note data that stored)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "aec8d43d-3d62-4d50-a158-c3b37ff86499",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 86,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "note data"
            ],
            "id": "bc693811-8f9d-43bd-99ca-852a18909e10",
            "source": {
              "cell": "67257914-5a7f-48b2-a6e1-0a69bf9359c9",
              "port": "5c460a18-b2a6-4905-8b12-f5f56cdd1e03"
            },
            "target": {
              "cell": "d17485b9-3364-4faa-a683-cf4306cad290",
              "port": "edc8c1a1-1e33-42f5-ae65-e926846de296"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "comment data",
              "description": "The data sent by the system to the content database when the system is trying to store data of a comment.\ncomment data contains:\n* comment: Comment (comment data that stored)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "b9af5669-ccf3-483f-8298-a4721eaa8c0b",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 84,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "comment data"
            ],
            "id": "ea01a47c-a094-4852-801e-41319621f2d6",
            "source": {
              "cell": "bc3d2055-2ef1-428a-83e0-fda91efd204e",
              "port": "5c460a18-b2a6-4905-8b12-f5f56cdd1e03"
            },
            "target": {
              "cell": "5cdedd4b-8793-42bd-80e7-76bb61ea18b1",
              "port": "edc8c1a1-1e33-42f5-ae65-e926846de296"
            },
            "vertices": [
              {
                "x": 1010,
                "y": 190
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "share data",
              "description": "The data sent by the system to the content database when the system is trying to store sharing data of a note.\n\nshare data contains:\nsharedNoteId: String\nnote: Note\npublic: Boolean\nsharedWith == []: List<User>\naccessLevel: Enum {Read, Write}",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "93829451-19f0-41da-89cf-e44a5c293238",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 85,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "share data"
            ],
            "id": "409985e1-7e3b-4ba8-bc9b-3a3838d33880",
            "source": {
              "cell": "da711e7e-161f-46a4-9ba7-e6c3dc79de0d",
              "port": "5c460a18-b2a6-4905-8b12-f5f56cdd1e03"
            },
            "target": {
              "cell": "fffd7ccf-dcc6-4a5b-822d-9e4fbcd334bd",
              "port": "edc8c1a1-1e33-42f5-ae65-e926846de296"
            },
            "vertices": [
              {
                "x": 1020,
                "y": 394
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "share confirmation",
              "description": "The response data sent by the system to a user when note sharing is completed.\nshare confirmation data\n- either contains (set private or public):\n* message (Indicates success or failure of the operation)\n* sharedNoteld: String\n* public:Boolean\n- or:\n* message (Indicates success or failure of the operation)\n* shareLink: URL (a shared secret link)\n* sharedNoteld: String\n* public: Boolean\n* accessLevel:Enum {Read,Write}",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "f933c9d4-249f-4b69-8f42-b0eeefd21b25",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 80,
                  "score": ""
                },
                {
                  "id": "1ca0600b-ecd7-4b91-8d33-c7f0b4e29c2c",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 120,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "share confirmation"
            ],
            "id": "1e0fc6fe-fb3f-45ae-96a7-50fe272b7fcf",
            "source": {
              "cell": "da711e7e-161f-46a4-9ba7-e6c3dc79de0d",
              "port": "5e99356c-5fdf-424b-ac0b-8e2a451d4c84"
            },
            "target": {
              "cell": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
              "port": "05967aeb-1e31-484f-9416-7b59c21dfadc"
            },
            "vertices": [
              {
                "x": 360,
                "y": 460
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "comment request",
              "description": "The request data sent by a user to the system when commenting on a note\ncomment request data contains:\n* userld: String\n* email: String\n* username: String\n* commentData: Comment",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "aa842fe0-361c-4003-b342-cbd8570629dd",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 77,
                  "score": ""
                },
                {
                  "id": "d47a182a-6a01-4e1c-b6a5-697b8e23a763",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 117,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "comment request"
            ],
            "id": "021b7538-c97d-4bdb-a3ee-17bf97d0ef9b",
            "source": {
              "cell": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
              "port": "deb5eb68-d1a8-4ceb-b7fb-be279e558fd2"
            },
            "target": {
              "cell": "bc3d2055-2ef1-428a-83e0-fda91efd204e",
              "port": "41637cef-6c49-4d3a-8d74-db63f6180532"
            },
            "vertices": [
              {
                "x": 420,
                "y": 220
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "share note request",
              "description": "The request data sent by a user to the system when sharing a note.\nshare note request \n- either contains (set private or public):\n* ownerUserId: String\n* public: Boolean\n- or:\n* ownerUserId: String\n* noteId: String\n* linkAccessLevel: Enum{Read, Write}\n",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "852229b4-b763-4d78-bef5-b45fe0d2e788",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 79,
                  "score": ""
                },
                {
                  "id": "ce553aa7-db50-45f3-9154-b25061580932",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 119,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "share note request"
            ],
            "id": "77875dd5-1613-49ff-bd1d-891aac276bb2",
            "source": {
              "cell": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
              "port": "deb5eb68-d1a8-4ceb-b7fb-be279e558fd2"
            },
            "target": {
              "cell": "da711e7e-161f-46a4-9ba7-e6c3dc79de0d",
              "port": "41637cef-6c49-4d3a-8d74-db63f6180532"
            },
            "vertices": [
              {
                "x": 390,
                "y": 390
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "ShareNote secured fire wall",
              "description": "The user and the server are separated",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "ShareNote secured fire wall"
            ],
            "id": "598650da-d6ef-4ff7-9873-7b581b3472bb",
            "source": {
              "x": 520,
              "y": -580
            },
            "target": {
              "x": 700,
              "y": 1140
            },
            "vertices": [
              {
                "x": 540,
                "y": -310
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "database operation",
              "description": "database operation data contains database operation commands",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "cabcdbb9-ec2b-492d-92c8-aaa2be06cd55",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 91,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "database operation"
            ],
            "id": "c03e07ed-a8b7-4a3b-a65b-b864336293f4",
            "source": {
              "cell": "bd26356a-c0a6-4c58-8c0e-5aaaadb95c54",
              "port": "8e699b55-bd42-464f-b280-274589ac26e8"
            },
            "target": {
              "cell": "d17485b9-3364-4faa-a683-cf4306cad290",
              "port": "a4fdfdba-00c2-4d88-8273-d7a7c6598fc9"
            },
            "vertices": [
              {
                "x": 1640,
                "y": 360
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "database operation",
              "description": "database operation data contains database operation commands",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "d3a51620-7248-4c87-886a-300378fadbf3",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 90,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "database operation"
            ],
            "id": "050083ad-75b8-4670-b019-90e3aaeb45fd",
            "source": {
              "cell": "bd26356a-c0a6-4c58-8c0e-5aaaadb95c54",
              "port": "8e699b55-bd42-464f-b280-274589ac26e8"
            },
            "target": {
              "cell": "5cdedd4b-8793-42bd-80e7-76bb61ea18b1",
              "port": "a4fdfdba-00c2-4d88-8273-d7a7c6598fc9"
            },
            "vertices": [
              {
                "x": 1450,
                "y": 500
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "comment confirmation",
              "description": "The response data sent by the system to a user when note commenting is completed.\ncomment confirmation data contains:\n* message (Indicates success or failure of the operation)\n- if success:\n* commentId: String\n* content: Text\n* createdAt: DateTime\n* author: User",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "36614bde-ffaa-429a-b68b-803f9191f2f3",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 78,
                  "score": ""
                },
                {
                  "id": "9861f795-1269-45fe-826d-05f85af4eb17",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 118,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "comment confirmation"
            ],
            "id": "9346a98e-50d8-41d5-9524-808902a33e1e",
            "source": {
              "cell": "bc3d2055-2ef1-428a-83e0-fda91efd204e",
              "port": "5e99356c-5fdf-424b-ac0b-8e2a451d4c84"
            },
            "target": {
              "cell": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
              "port": "deb5eb68-d1a8-4ceb-b7fb-be279e558fd2"
            },
            "vertices": [
              {
                "x": 420,
                "y": 260
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "create confirmation",
              "description": "The response data sent by the system to a user when note creation is completed.\ncreate confirmation data contains:\n* message (Indicates success or failure of the operation)\n- if success:\n* redirectNote: Note (object to which the user will be redirected)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "962ba73d-a4df-4aaa-97d6-f6c6ade7e2d5",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 76,
                  "score": ""
                },
                {
                  "id": "e8ad68c9-944d-436d-9e1a-c34331c3d028",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 116,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "create confirmation"
            ],
            "id": "36fab548-c73c-4cc2-949c-a69edb44b866",
            "source": {
              "cell": "67257914-5a7f-48b2-a6e1-0a69bf9359c9",
              "port": "5e99356c-5fdf-424b-ac0b-8e2a451d4c84"
            },
            "target": {
              "cell": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
              "port": "deb5eb68-d1a8-4ceb-b7fb-be279e558fd2"
            },
            "vertices": [
              {
                "x": 460,
                "y": 160
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "comment data",
              "description": "The data sent by the content database to the system when the system is trying to retrieve a note's comment data.\ncomment data contains:\n* comments: List<Comment> (comment data that requested)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "6addd082-ea92-44fa-ac8e-d08cf78aa2cf",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 83,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "comment data"
            ],
            "id": "f257c8ee-c38f-4a4b-ab30-46ce80cf4403",
            "source": {
              "cell": "5cdedd4b-8793-42bd-80e7-76bb61ea18b1",
              "port": "6f30a397-e452-4545-805b-fc97454e980a"
            },
            "target": {
              "cell": "fc1dc17e-6ec8-4043-a69d-297ff7432bed",
              "port": "15d23439-4f47-46e0-b570-903d288ec324"
            },
            "vertices": [
              {
                "x": 1080,
                "y": 80
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note data",
              "description": "The data sent by the content database to the system when the system is trying to retrieve a note's content data.\nnote data contains:\n* note: Note (note data that requested)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "7972b025-f791-4ea0-aeaa-d96f1220acc3",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 82,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "note data"
            ],
            "id": "f7daf84a-9597-4e90-8a0c-ecb202e9d3c5",
            "source": {
              "cell": "d17485b9-3364-4faa-a683-cf4306cad290",
              "port": "6f30a397-e452-4545-805b-fc97454e980a"
            },
            "target": {
              "cell": "fc1dc17e-6ec8-4043-a69d-297ff7432bed",
              "port": "15d23439-4f47-46e0-b570-903d288ec324"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "view request",
              "description": "The request data sent by a user to the system when request to view a note.\nview request data contains:\n* noteId: String",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "ddb92667-3569-4e5e-a813-40e1faaa4291",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 74,
                  "score": ""
                },
                {
                  "id": "e073ab81-c7a9-47c8-9986-11ab578d99e2",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 113,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "view request"
            ],
            "id": "10ad3e92-7588-4f66-870e-ede216337530",
            "source": {
              "cell": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
              "port": "deb5eb68-d1a8-4ceb-b7fb-be279e558fd2"
            },
            "target": {
              "cell": "fc1dc17e-6ec8-4043-a69d-297ff7432bed",
              "port": "b5696da3-bf3b-4d75-9431-0a14a7f33028"
            },
            "vertices": [
              {
                "x": 280,
                "y": 60
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "view request",
              "description": "The request data sent by a user to the system when request to view a note.\nview request data contains:\n* noteId: String",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "94e5b799-16e9-4205-ad28-f5a3f3ec6064",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "for example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 72,
                  "score": ""
                },
                {
                  "id": "542cefd3-12a2-4d18-8092-19e0d7a09612",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 111,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "view request"
            ],
            "id": "982b07f6-076b-4a86-a652-14007ef0c2af",
            "source": {
              "cell": "ec7fa741-b677-429d-affe-09df6394501f",
              "port": "f6538eb0-9359-49af-a1fe-f6c068420955"
            },
            "target": {
              "cell": "fc1dc17e-6ec8-4043-a69d-297ff7432bed",
              "port": "b5696da3-bf3b-4d75-9431-0a14a7f33028"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note and comment ",
              "description": "The response note data sent by the system to a user when viewing a note.\nnote and comment data contains:\n* noteId: String\n* title: String\n* content: Content,\n* createdAt: DateTime\n* owner: User\n* comments: List<Comment>",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "8ff61a66-bbdc-4c10-b157-fad1f7f415bc",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 75,
                  "score": ""
                },
                {
                  "id": "3d60b9f7-81dc-473e-aec3-5221aefc4c9c",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 114,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "note and comment "
            ],
            "id": "318dbdef-9fd8-4926-999d-703d87fe81a1",
            "source": {
              "cell": "fc1dc17e-6ec8-4043-a69d-297ff7432bed",
              "port": "9083d14c-b283-4c84-b1e0-a93b56c41d29"
            },
            "target": {
              "cell": "c8fad56e-7a3f-4ba6-9bfd-1f767e48a323",
              "port": "deb5eb68-d1a8-4ceb-b7fb-be279e558fd2"
            },
            "vertices": [
              {
                "x": 430,
                "y": 60
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "note and comment",
              "description": "The response note data sent by the system to a user when viewing a note.\nnote and comment data contains:\n* noteId: String\n* title: String\n* content: Content,\n* createdAt: DateTime\n* owner: User\n* comments: List<Comment>",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "1be8c48a-9418-4097-8dbb-dc1353428a9a",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 73,
                  "score": ""
                },
                {
                  "id": "5700e3e7-8191-4ad2-bc10-5ed38d804697",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 112,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "note and comment"
            ],
            "id": "740c3142-13a7-45a5-83e8-f6a966eccc1b",
            "source": {
              "cell": "fc1dc17e-6ec8-4043-a69d-297ff7432bed",
              "port": "9083d14c-b283-4c84-b1e0-a93b56c41d29"
            },
            "target": {
              "cell": "ec7fa741-b677-429d-affe-09df6394501f",
              "port": "f6538eb0-9359-49af-a1fe-f6c068420955"
            },
            "vertices": [
              {
                "x": 360,
                "y": -60
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "modification confirmation",
              "description": "The data sent by the system to an admin when the system notify the confirmation of modification to the admin.\nmodification confirmation data contains:\n* message (Indicates success or failure of the operation)\n* the data returned by the system and displayed on the interface, can be note data, comment data, SharedNote data",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "2e9afade-b334-4481-9e05-a3e76717be50",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 88,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "modification confirmation"
            ],
            "id": "90320d4e-1d6c-4b89-b1b2-5dd5109a25c6",
            "source": {
              "cell": "bd26356a-c0a6-4c58-8c0e-5aaaadb95c54",
              "port": "cc567b8b-1d87-4e94-be27-b80f4eddac10"
            },
            "target": {
              "cell": "8f4422f4-718e-4a9e-bef8-1b8905e7b889",
              "port": "568ae002-dee4-4afd-adc4-c1860840021e"
            },
            "tools": {
              "items": [
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead"
              ],
              "name": null
            },
            "vertices": [
              {
                "x": 940,
                "y": 730
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "login data",
              "description": "The request data sent by a user to the system when logging to the system.\n\nlogin data contains:\n* Username / Email – The unique identifier for the user’s account.\n* Password – The secret key chosen by the user for account access.\nSession Token / Cookie – Created after successful login to keep the user authenticated without re-entering credentials.\n* Multi-Factor Authentication (MFA) Code (if implemented) – A one-time passcode sent to email/SMS or generated by an authenticator app.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "32592532-946a-4f74-b377-e52f509f9aaf",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "for example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 98,
                  "score": ""
                },
                {
                  "id": "d338f87b-1573-45f6-a68a-66f928bb09df",
                  "title": "Sensitive data exposure",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Sensitive information may be transmitted without sufficient protection or accidentally logged. This could allow unauthorized users or attackers to read or misuse the data, especially if intercepted during transit or leaked through error messages.",
                  "mitigation": "- Encrypt all communications via TLS\n- Avoid including sensitive information in error responses",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 110,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "login data"
            ],
            "id": "602e41b9-6ae1-42ab-8ae7-946071819b40",
            "source": {
              "cell": "ec7fa741-b677-429d-affe-09df6394501f",
              "port": "f6538eb0-9359-49af-a1fe-f6c068420955"
            },
            "target": {
              "cell": "4edad714-ae72-4127-b8d1-54d765a1d367",
              "port": "bf79f26d-616c-4bac-bbc0-817766405c82"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "end-user personal\ndetails",
              "description": "The data sent by the user database to the system when the system is trying to verify an end-user's personal data.\nIdentity Information\nFull name\nUsername / display name\nProfile picture\nContact Information\nEmail address\nPhone number (if required for MFA or notifications)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "270dc14e-2b30-432b-b17d-16a41f12f4a5",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 100,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "end-user personal\ndetails"
            ],
            "id": "202f1141-e5b4-4c4f-b09a-003ce94999db",
            "source": {
              "cell": "4edad714-ae72-4127-b8d1-54d765a1d367",
              "port": "45877ef0-452c-40f2-95e8-c29668fab3d5"
            },
            "target": {
              "cell": "b1556f56-9688-492a-bbc5-f38c4c83e415",
              "port": "91903c17-f095-4151-9442-5fd8fb391443"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "personal details data",
              "description": "The request data sent by a user to the system when registering.\nPersonal details data contains:\n  * full name\n  * address\n  * mobile phone number\n  * email address\n  * password",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "ba421356-fbc5-4953-9e33-097235bf0e39",
                  "title": "Personal data can be stolen",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "An adversary in the middle can steal the personal data of the user.",
                  "mitigation": "Use Transport Layer Security (TLS) for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 104,
                  "score": ""
                },
                {
                  "id": "0736062b-493a-460d-b40a-75cd422efcea",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "for example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 109,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 2,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "personal details data"
            ],
            "id": "ac2499f7-460f-4c0f-bcea-1dcb12b53a11",
            "source": {
              "cell": "ec7fa741-b677-429d-affe-09df6394501f",
              "port": "f6538eb0-9359-49af-a1fe-f6c068420955"
            },
            "target": {
              "cell": "4cb9ca11-a975-48c9-8cb3-90069ad09959",
              "port": "bf79f26d-616c-4bac-bbc0-817766405c82"
            },
            "vertices": []
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Web Server / Database Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "Web Server / Database Boundary"
            ],
            "id": "e2897330-d30f-49c3-bec1-3cf727e18cfc",
            "source": {
              "x": 840,
              "y": -730
            },
            "target": {
              "x": 1040,
              "y": 1170
            },
            "vertices": [
              {
                "x": 990,
                "y": 430
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "end-user personal data",
              "description": "The data sent by the system to the user database when the system is trying to store an end-user's personal data.\nend-user personal data contains:\n* Identity Information, this includes:\nFull name\nUsername / display name\nProfile picture\nContact Information\nEmail address\nPhone number (if required for MFA or notifications)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "dae33c33-1b7f-4cd9-bed3-ec4d5ed7426e",
                  "title": "Insecure connection",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "For example, data can be tampered by an adversary in the middle where the address for the delivery can be modified.",
                  "mitigation": "Use Transport Layer Security for the communication.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 105,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "end-user personal data"
            ],
            "id": "4b13c331-e417-43ed-94cf-ebb9a630f296",
            "source": {
              "cell": "4cb9ca11-a975-48c9-8cb3-90069ad09959",
              "port": "45877ef0-452c-40f2-95e8-c29668fab3d5"
            },
            "target": {
              "cell": "b1556f56-9688-492a-bbc5-f38c4c83e415",
              "port": "91903c17-f095-4151-9442-5fd8fb391443"
            },
            "vertices": []
          },
          {
            "position": {
              "x": 670,
              "y": -70
            },
            "size": {
              "width": 170,
              "height": 150
            },
            "attrs": {
              "text": {
                "text": "Create Note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "015182bd-bcac-42e8-8d8a-bc91f5e60157"
                },
                {
                  "group": "right",
                  "id": "5c460a18-b2a6-4905-8b12-f5f56cdd1e03"
                },
                {
                  "group": "bottom",
                  "id": "5e99356c-5fdf-424b-ac0b-8e2a451d4c84"
                },
                {
                  "group": "left",
                  "id": "41637cef-6c49-4d3a-8d74-db63f6180532"
                }
              ]
            },
            "id": "67257914-5a7f-48b2-a6e1-0a69bf9359c9",
            "data": {
              "type": "tm.Process",
              "name": "Create Note",
              "description": "Action for a user to create a note for themselves in the ShareNote system.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "41331464-40d4-4207-91a4-b64bc1d37d1d",
                  "title": "HTTPS downgrade attack",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attempt to access site via HTTP\t",
                  "mitigation": "- Enforce HTTPS with HSTS headers\n- Redirect HTTP request to HTTPS",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                },
                {
                  "id": "b578ff0f-b3c3-4f39-a64c-66aff9ebc999",
                  "title": "Excessive Note Creating Requests",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Denial of service",
                  "description": "A user sends a large number of create requests, overloading the server or database.",
                  "mitigation": "- Enable DDOS protection on reverse proxy server\n- Enable CAPTCHA\n- Apply rate limiting per user/IP\n- Cache non-sensitive content\n- Monitor and block abnormal request patterns",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 44,
                  "score": ""
                },
                {
                  "id": "9eb89a1a-77a6-4e37-ba90-b93254c65f7e",
                  "title": "Impersonation of Another User to Create Note",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Spoofing",
                  "description": "An attacker attempts to create a note under another user’s account by forging authentication credentials or session tokens.",
                  "mitigation": "- Validate session tokens for each request\n- Enforce server-side checks to confirm note ownership\n- Use Multi-Factor Authentication (MFA) for sensitive actions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 52,
                  "score": ""
                },
                {
                  "id": "364a79cc-976f-4a3c-baf7-614d5e3c7928",
                  "title": "Injection of Malicious Content",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "A user inserts harmful scripts or malicious code into the note content to exploit other users when the note is viewed.",
                  "mitigation": "- Implement server-side input validation and sanitization\n- Use context-aware output encoding\n- Apply Content Security Policy (CSP) to prevent script execution",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 56,
                  "score": ""
                },
                {
                  "id": "73bef155-304b-408d-8367-fb819a6b52b1",
                  "title": "Repudiation of Note Creation",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Repudiation",
                  "description": "A user denies creating a specific note, making it hard to hold them accountable.",
                  "mitigation": "- Maintain tamper-proof creation logs\n- Include user ID, timestamp, and note metadata in logs\n- Store logs in an append-only or immutable format",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 57,
                  "score": ""
                },
                {
                  "id": "8802f207-3c11-41ba-a4b3-07d0a9a64c0f",
                  "title": "Unauthorized Access to Sensitive Data",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "The note creation process inadvertently exposes sensitive information through debug messages, error responses, or unsecured storage.",
                  "mitigation": "- Avoid including sensitive data in client responses\n- Use secure error handling without revealing internal details\n- Encrypt sensitive fields in storage",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 58,
                  "score": ""
                },
                {
                  "id": "7b0d1556-03eb-41fc-8547-ba6b339dfe6d",
                  "title": "Escalating Privileges through Note Creation",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Elevation of privilege",
                  "description": "A user exploits the note creation function to gain unauthorized privileges, such as setting themselves as the owner of another user’s note.",
                  "mitigation": "- Enforce strict server-side ownership assignment\n- Validate all role and permission changes\n- Implement role-based access control (RBAC) at the database level",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 61,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 2,
                "repudiation": 1,
                "informationDisclosure": 4,
                "denialOfService": 3,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 1395,
              "y": -10
            },
            "size": {
              "width": 150,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Content Datastore"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "6f30a397-e452-4545-805b-fc97454e980a"
                },
                {
                  "group": "right",
                  "id": "a4d57457-948a-4327-adfb-19c9b9b9da83"
                },
                {
                  "group": "bottom",
                  "id": "a4fdfdba-00c2-4d88-8273-d7a7c6598fc9"
                },
                {
                  "group": "left",
                  "id": "edc8c1a1-1e33-42f5-ae65-e926846de296"
                }
              ]
            },
            "id": "d17485b9-3364-4faa-a683-cf4306cad290",
            "data": {
              "type": "tm.Store",
              "name": "Content Datastore",
              "description": "This database contains all note content data.\nevery entry contains:\n* text: String\n* images: List<lmage>\n* links: List<Link>\n* referencedNotes:List<Note>",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "d9f9fc60-982b-4227-9de2-fbe8df172082",
                  "title": "Datastore unwanted access",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "The datastore must be access-protected to only authorised personnel. ",
                  "mitigation": "- Datastore credentials are securely stored on password vaults with limited set of users having access (apply least privilege principle).\n- Datastore credentials are injected into connecting software from secured variables or files (apply least privilege principle).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 92,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 1175,
              "y": 130.0000000000001
            },
            "size": {
              "width": 150,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Comment Datastore"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 15,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "6f30a397-e452-4545-805b-fc97454e980a"
                },
                {
                  "group": "right",
                  "id": "a4d57457-948a-4327-adfb-19c9b9b9da83"
                },
                {
                  "group": "bottom",
                  "id": "a4fdfdba-00c2-4d88-8273-d7a7c6598fc9"
                },
                {
                  "group": "left",
                  "id": "edc8c1a1-1e33-42f5-ae65-e926846de296"
                }
              ]
            },
            "id": "5cdedd4b-8793-42bd-80e7-76bb61ea18b1",
            "data": {
              "type": "tm.Store",
              "name": "Comment Datastore",
              "description": "This database contains all comment data.\nevery entry contains:\n* commentld: String\n* content: Text\n* createdAt: DateTime\n* author:User",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "c36f8b96-1add-458a-b479-35e181a4790f",
                  "title": "Datastore unwanted access",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "The datastore must be access-protected to only authorised personnel. ",
                  "mitigation": "- Datastore credentials are securely stored on password vaults with limited set of users having access (apply least privilege principle).\n- Datastore credentials are injected into connecting software from secured variables or files (apply least privilege principle).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 93,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 690,
              "y": 145
            },
            "size": {
              "width": 200,
              "height": 150
            },
            "attrs": {
              "text": {
                "text": "Comment on Note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 16,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "015182bd-bcac-42e8-8d8a-bc91f5e60157"
                },
                {
                  "group": "right",
                  "id": "5c460a18-b2a6-4905-8b12-f5f56cdd1e03"
                },
                {
                  "group": "bottom",
                  "id": "5e99356c-5fdf-424b-ac0b-8e2a451d4c84"
                },
                {
                  "group": "left",
                  "id": "41637cef-6c49-4d3a-8d74-db63f6180532"
                }
              ]
            },
            "id": "bc3d2055-2ef1-428a-83e0-fda91efd204e",
            "data": {
              "type": "tm.Process",
              "name": "Comment on Note",
              "description": "Action for a user to comment on a specific note they can access in the ShareNote system.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "83327ab6-b126-45a3-a52b-90c6043f9789",
                  "title": "Note or comment tampering",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Unauthorized editing or deletion via compromised session or link without authorization.",
                  "mitigation": "- Use secure tokens, validate permissions on every request.\n- Implement role-based permissions for comment management",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                },
                {
                  "id": "b79c9196-ff0b-438f-9bc0-17e28cd65be8",
                  "title": "Denial of creating/editing notes or comments",
                  "status": "Open",
                  "severity": "High",
                  "type": "Repudiation",
                  "description": "A user denies having created or removed a comment, making it difficult to trace actions.",
                  "mitigation": "- Maintain tamper-proof comment logs\n- Include user ID, timestamp, and note ID in records\n- Store logs in an append-only format",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                },
                {
                  "id": "dac3a80c-141e-4125-ae8b-a0ad13723859",
                  "title": "Flooding note creation/comments",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Denial of service",
                  "description": "A malicious user sends a large number of comment requests, overloading the server or database and overwhelm storage.",
                  "mitigation": "- Limit number of comment submissions per user under the same note\n- Enable DDOS protection on reverse proxy server\n- Enable CAPTCHA\n- Apply rate limiting per user/IP\n- Cache non-sensitive content\n- Monitor and block abnormal request patterns",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                },
                {
                  "id": "266d68be-026a-4cf3-b654-00709b4f532c",
                  "title": "HTTPS downgrade attack",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "Attempt to access site via HTTP\t",
                  "mitigation": "- Enforce HTTPS with HSTS headers\n- Redirect HTTP request to HTTPS",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 49,
                  "score": ""
                },
                {
                  "id": "5fb37aca-60ab-49e6-b15d-41af87d5593f",
                  "title": "Impersonation of Another User to Comment on Note",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Spoofing",
                  "description": "An attacker attempts to comment on a note under another user’s account by forging authentication credentials or session tokens.",
                  "mitigation": "- Validate session tokens for each request\n- Enforce server-side checks to confirm note ownership\n- Use Multi-Factor Authentication (MFA) for sensitive actions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 53,
                  "score": ""
                },
                {
                  "id": "5f01c901-03ba-468c-99c7-bede83c3d227",
                  "title": "Unauthorized Access to Sensitive Data",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "The commenting process inadvertently exposes sensitive information through debug messages, error responses, or unsecured storage.",
                  "mitigation": "- Avoid including sensitive data in client responses\n- Use secure error handling without revealing internal details\n- Encrypt sensitive fields in storage",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 59,
                  "score": ""
                },
                {
                  "id": "73234378-094f-4414-bd4c-474e8599cb03",
                  "title": "Leaking Sensitive Information Through Comments",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Comments may inadvertently contain sensitive content (e.g., private note details, credentials) that becomes visible to others.",
                  "mitigation": "- Educate users about safe content in comments\n- Allow note owners to delete inappropriate comments\n- Restrict comment visibility based on note access",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 62,
                  "score": ""
                },
                {
                  "id": "c9015202-0285-45a8-8158-e4e853b654c4",
                  "title": "Injection of Malicious Content",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "A user inserts harmful scripts or malicious code into the comment to exploit other users when the note is viewed.",
                  "mitigation": "- Implement server-side input validation and sanitization\n- Use context-aware output encoding\n- Apply Content Security Policy (CSP) to prevent script execution",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 63,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 5,
                "repudiation": 3,
                "informationDisclosure": 4,
                "denialOfService": 5,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 750,
              "y": 350
            },
            "size": {
              "width": 170,
              "height": 150
            },
            "attrs": {
              "text": {
                "text": "Share Note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 17,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "015182bd-bcac-42e8-8d8a-bc91f5e60157"
                },
                {
                  "group": "right",
                  "id": "5c460a18-b2a6-4905-8b12-f5f56cdd1e03"
                },
                {
                  "group": "bottom",
                  "id": "5e99356c-5fdf-424b-ac0b-8e2a451d4c84"
                },
                {
                  "group": "left",
                  "id": "41637cef-6c49-4d3a-8d74-db63f6180532"
                }
              ]
            },
            "id": "da711e7e-161f-46a4-9ba7-e6c3dc79de0d",
            "data": {
              "type": "tm.Process",
              "name": "Share Note",
              "description": "Action for a note creator to share a note by making it public in read-only mode or by generating a secret link granting read or edit access to specific users.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "47474b30-478f-473f-9007-e73a5df2c07b",
                  "title": "Shared link misuse",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Spoofing",
                  "description": "Link-based access lacks identity verification.",
                  "mitigation": "Add optional login requirement for link-based access.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                },
                {
                  "id": "9e171f9e-d93d-4e9d-85b6-426c401307a5",
                  "title": "Replay attacks with links",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "Editing via previously shared links.",
                  "mitigation": "Implement link expiry, one-time use options.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                },
                {
                  "id": "4cd20659-f423-4836-9e22-b3dc57541e01",
                  "title": "Leaking Secret Share Links",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Private share links may be exposed via referrer headers, browser history, or intercepted if not protected. Anyone with the link may access sensitive content.",
                  "mitigation": "- Generate high-entropy, unguessable tokens\n- Allow owners to revoke share links and set expiration times",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                },
                {
                  "id": "0181b12c-3bc0-43b7-bf44-eaf666eca5c3",
                  "title": "Public notes indexed by search engines",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Public notes may unintentionally expose data.",
                  "mitigation": "Use robots.txt, add warnings before making notes public.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": ""
                },
                {
                  "id": "cccc6507-3950-40d4-97be-d1b5b0615aa3",
                  "title": "Excessive Viewing Requests",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "A user sends a large number of share note requests, overloading the server or database.",
                  "mitigation": "- Enable DDOS protection on reverse proxy server\n- Enable CAPTCHA\n- Apply rate limiting per user/IP\n- Cache non-sensitive content\n- Monitor and block abnormal request patterns",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                },
                {
                  "id": "8d03b94e-0092-4a8f-8f46-dfd56a0c7d28",
                  "title": "HTTPS downgrade attack",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "Attempt to access site via HTTP\t",
                  "mitigation": "- Enforce HTTPS with HSTS headers\n- Redirect HTTP request to HTTPS",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 51,
                  "score": ""
                },
                {
                  "id": "161bbd6c-c02e-481f-af54-60d434badabf",
                  "title": "Impersonation of Another User to Share Note",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Spoofing",
                  "description": "An attacker attempts to share a note under another user’s account by forging authentication credentials or session tokens.",
                  "mitigation": "- Validate session tokens for each request\n- Enforce server-side checks to confirm note ownership\n- Use Multi-Factor Authentication (MFA) for sensitive actions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 55,
                  "score": ""
                },
                {
                  "id": "1c1759d4-8dde-4c40-ada9-5b6112fc438e",
                  "title": "Unauthorized Access to Sensitive Data",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "The sharing note process inadvertently exposes sensitive information through debug messages, error responses, or unsecured storage.",
                  "mitigation": "- Avoid including sensitive data in client responses\n- Use secure error handling without revealing internal details\n- Encrypt sensitive fields in storage",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 60,
                  "score": ""
                },
                {
                  "id": "8ca1bd60-e7f9-472b-b43b-7d491fb03e0d",
                  "title": "Altering Share Permissions",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "A malicious user modifies parameters (e.g., accessLevel, public flag) in the share request to grant unauthorized access.",
                  "mitigation": "- Validate all input server-side\n- Enforce role-based access control (RBAC) at the API level\n- Reject unauthorized changes to note permissions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 64,
                  "score": ""
                },
                {
                  "id": "b8370e8a-a6a2-4e67-b305-0d066b3f961e",
                  "title": "Denying a Share Action",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Repudiation",
                  "description": "A user claims they never shared a note, making it difficult to prove the action took place.",
                  "mitigation": "- Maintain tamper-proof share activity logs\n- Include user ID, note ID, access level, and timestamp\n- Protect logs from modification",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 65,
                  "score": ""
                },
                {
                  "id": "20bbb747-7ece-47d0-8a4d-fa939163833c",
                  "title": "Escalating Access Through Sharing",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Elevation of privilege",
                  "description": "A user with limited permissions shares a note in a way that grants themselves or others higher privileges (e.g., read → edit).",
                  "mitigation": "- Validate permission changes on the server\n- Restrict share operations to authorized roles\n- Require explicit confirmation for privilege-increasing shares",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 66,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 4,
                "tampering": 4,
                "repudiation": 1,
                "informationDisclosure": 6,
                "denialOfService": 4,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 1145,
              "y": 350
            },
            "size": {
              "width": 140,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "SharedNote Datastore"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 18,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "6f30a397-e452-4545-805b-fc97454e980a"
                },
                {
                  "group": "right",
                  "id": "a4d57457-948a-4327-adfb-19c9b9b9da83"
                },
                {
                  "group": "bottom",
                  "id": "a4fdfdba-00c2-4d88-8273-d7a7c6598fc9"
                },
                {
                  "group": "left",
                  "id": "edc8c1a1-1e33-42f5-ae65-e926846de296"
                }
              ]
            },
            "id": "fffd7ccf-dcc6-4a5b-822d-9e4fbcd334bd",
            "data": {
              "type": "tm.Store",
              "name": "SharedNote Datastore",
              "description": "This database contains all note sharing information data.\nevery entry contains:\n* sharedNoteld: String\n* note: Note\n* public: Boolean\n* sharedWith: List<User>\naccessLevel:Enum {Read, Write}",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "7d1eb150-6b45-4e35-a538-1452420691e2",
                  "title": "Datastore unwanted access",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "The datastore must be access-protected to only authorised personnel. ",
                  "mitigation": "- Datastore credentials are securely stored on password vaults with limited set of users having access (apply least privilege principle).\n- Datastore credentials are injected into connecting software from secured variables or files (apply least privilege principle).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 94,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 730,
              "y": 540
            },
            "size": {
              "width": 220,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Database Server Administrator "
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 19,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "2c46b0b0-2244-410c-b72a-eb32a515641e"
                },
                {
                  "group": "right",
                  "id": "b8ac6174-c65c-4e67-ab88-936f9c38b1aa"
                },
                {
                  "group": "bottom",
                  "id": "568ae002-dee4-4afd-adc4-c1860840021e"
                },
                {
                  "group": "left",
                  "id": "1613bae0-bbbc-46ed-83ae-6087ea9e07fb"
                }
              ]
            },
            "id": "8f4422f4-718e-4a9e-bef8-1b8905e7b889",
            "data": {
              "type": "tm.Actor",
              "name": "Database Server Administrator ",
              "description": "Database server administrator are privileged users with control over the ShareNote system. They can manage user accounts, assign permissions, delete content, perform backups, and directly modify the database through administrative processes.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "5ed9086b-27f2-4818-af93-f07439c46fe9",
                  "title": "Impersonation of an Administrator Account",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker or malicious insider may attempt to gain administrator privileges by stealing admin credentials, forging admin session tokens, or exploiting authentication flaws.",
                  "mitigation": "- Require Multi-Factor Authentication (MFA) for admin logins\n- Restrict admin access to trusted IP ranges or VPN\n- Use strong, unique passwords with enforced rotation\n- Monitor and alert on unusual login activity",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 38,
                  "score": ""
                },
                {
                  "id": "6cea435f-83ee-4c30-aa77-f71b7db367d5",
                  "title": "Repudiation of Administrative Actions",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "An administrator could deny having performed a system change (e.g., deleting a note, modifying the database), making accountability difficult.",
                  "mitigation": "- Maintain secure, tamper-proof audit logs\n- Digitally sign and timestamp all administrative actions\n- Store logs in an append-only system\n- Regularly review logs with separation of duties",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 39,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 3,
                "repudiation": 4
              }
            },
            "children": [
              "d625b9f5-5cd7-4699-a56c-0b1ee3d464cb"
            ]
          },
          {
            "position": {
              "x": 1140,
              "y": 680
            },
            "size": {
              "width": 150,
              "height": 150
            },
            "attrs": {
              "text": {
                "text": "Modify System Data"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 20,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1d73b472-93be-4436-a7ae-8b6e5f212411"
                },
                {
                  "group": "right",
                  "id": "8e699b55-bd42-464f-b280-274589ac26e8"
                },
                {
                  "group": "bottom",
                  "id": "cc567b8b-1d87-4e94-be27-b80f4eddac10"
                },
                {
                  "group": "left",
                  "id": "7a852e9b-0701-447a-a875-6e4318343331"
                }
              ]
            },
            "id": "bd26356a-c0a6-4c58-8c0e-5aaaadb95c54",
            "data": {
              "type": "tm.Process",
              "name": "Modify System Data",
              "description": "Action for an administrator to directly update, insert, or delete records in the database, including user accounts, notes, comments, and system configurations.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "5c029be7-cff6-40d1-a454-a2028abbc950",
                  "title": "Audit Logging",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "Provide a description for this threat",
                  "mitigation": "Track all key user and system actions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 29,
                  "score": ""
                },
                {
                  "id": "254d86c0-16ea-4e57-b7ed-be52c6427e6b",
                  "title": "Impersonating an Administrator",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Spoofing",
                  "description": "An attacker gains access to admin credentials or session tokens and uses the modify system data process to alter critical records.",
                  "mitigation": "- Enforce Multi-Factor Authentication (MFA) for admin accounts\n- Restrict admin access to trusted IPs or VPNs\n- Monitor and alert on unusual admin activity",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 67,
                  "score": ""
                },
                {
                  "id": "ee15863a-5e84-4ab1-a454-6271525d0909",
                  "title": "Repudiation of Administrative Actions",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Repudiation",
                  "description": "An administrator could deny having performed a system change (e.g., deleting a note, modifying the database), making accountability difficult.",
                  "mitigation": "- Maintain secure, tamper-proof audit logs\n- Digitally sign and timestamp all administrative actions\n- Store logs in an append-only system\n- Regularly review logs with separation of duties",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 68,
                  "score": ""
                },
                {
                  "id": "38f48395-b280-46c8-9dc6-04fd4ede3464",
                  "title": "Exposing Sensitive Data During Modification",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Admin changes may reveal sensitive data in logs, error messages, or insecure channels.",
                  "mitigation": "- Mask sensitive fields in logs\n- Use secure channels for all admin operations (HTTPS/SSH)\n- Restrict access",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 69,
                  "score": ""
                },
                {
                  "id": "2aba689d-7d4f-44bf-9b47-aa52798937d8",
                  "title": "Privilege Abuse",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Elevation of privilege",
                  "description": "Admin (Database Server Administrator and Internal Staff) uses modify system data process to grant themselves or another account higher privileges than intended.",
                  "mitigation": "- Separate admin roles (e.g., DB admin vs. app admin)\n- Require change approvals for privilege alterations\n- Periodically review account privileges\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 70,
                  "score": ""
                },
                {
                  "id": "59338852-0909-484a-817c-fcfb713f41a0",
                  "title": "Resource Exhaustion Through Bulk Changes",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Denial of service",
                  "description": "Admin runs heavy modification scripts or queries that overwhelm the database or lock key tables.",
                  "mitigation": "- Limit the size and frequency of bulk operations\n- Schedule large changes during maintenance windows\n- Implement query execution timeouts",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 71,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 2,
                "repudiation": 2,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 3
              }
            }
          },
          {
            "position": {
              "x": -109.99999999999996,
              "y": -160
            },
            "size": {
              "width": 230,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Anonymous user (Guest) "
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 21,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "787de4c1-7af4-4a7e-a2e6-01b6e0dff6e9"
                },
                {
                  "group": "right",
                  "id": "f6538eb0-9359-49af-a1fe-f6c068420955"
                },
                {
                  "group": "bottom",
                  "id": "6304fd6c-1530-49ac-a87d-910deea77fab"
                },
                {
                  "group": "left",
                  "id": "fa0bc949-feac-4954-bd01-62329d166b12"
                }
              ]
            },
            "id": "ec7fa741-b677-429d-affe-09df6394501f",
            "data": {
              "type": "tm.Actor",
              "name": "Anonymous user (Guest) ",
              "description": "Guests are users who have not logged into the ShareNote system. They can view public notes but cannot create, edit, comment on, or share notes.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "4634986d-d8be-4dc2-a7c7-8354637656eb",
                  "title": "Impersonation of Another User",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "A guest may attempt to masquerade as another user by guessing session tokens, forging cookies, or manipulating request headers.",
                  "mitigation": "- Enforce strong session management\n- Validate authentication tokens\n- Reject requests without valid credentials",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 34,
                  "score": ""
                },
                {
                  "id": "996767bf-4771-4bb6-8c4b-02f7401b0b2b",
                  "title": "False Action Denial",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Repudiation",
                  "description": "Unauthenticated guests can perform actions (e.g., access public content) and later deny having done so, making tracking difficult.",
                  "mitigation": "- Use IP-based logging\n- Implement request fingerprinting\n- Append anonymous session IDs to activity logs",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 35,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "repudiation": 1
              }
            }
          },
          {
            "position": {
              "x": 630,
              "y": -280
            },
            "size": {
              "width": 180,
              "height": 150
            },
            "attrs": {
              "text": {
                "text": "View Note"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 22,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "05ff5d98-4c5c-45dc-b747-b0968f8c55ed"
                },
                {
                  "group": "right",
                  "id": "15d23439-4f47-46e0-b570-903d288ec324"
                },
                {
                  "group": "bottom",
                  "id": "9083d14c-b283-4c84-b1e0-a93b56c41d29"
                },
                {
                  "group": "left",
                  "id": "b5696da3-bf3b-4d75-9431-0a14a7f33028"
                }
              ]
            },
            "id": "fc1dc17e-6ec8-4043-a69d-297ff7432bed",
            "data": {
              "type": "tm.Process",
              "name": "View Note",
              "description": "Action for a user to view a specific note they have permission to access in the ShareNote system",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "09dcccf2-bdcd-4862-acf8-7a26b5835700",
                  "title": "Unauthorized Access to Notes",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Spoofing",
                  "description": "An attacker pretends to be an authorized user (e.g., by using stolen session tokens) to view notes they shouldn’t have access to.",
                  "mitigation": "- Validate session tokens for every request\n- Enforce strict server-side access control\n- Implement Multi-Factor Authentication (MFA) for sensitive accounts",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 40,
                  "score": ""
                },
                {
                  "id": "a206c84b-351d-47f9-aa5c-ba416611e401",
                  "title": "Manipulating Request Parameters",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "A user alters parameters (e.g., noteId) in the request to view another user’s note without permission.",
                  "mitigation": "- Perform server-side authorization checks\n- Validate all input against expected formats",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 41,
                  "score": ""
                },
                {
                  "id": "1fcde0ed-e2a1-4f9a-9734-a49cf8be1add",
                  "title": "Exposure of Sensitive Information",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Viewing a note may expose sensitive content to unauthorized parties if access control is flawed or the note is cached in public areas.",
                  "mitigation": "- Enforce strict access checks before returning content\n- Prevent caching of sensitive pages",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 42,
                  "score": ""
                },
                {
                  "id": "890e7e23-a55f-4a2a-926f-7f0829fb8c7a",
                  "title": "Excessive Viewing Requests",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Denial of service",
                  "description": "A user sends a large number of view requests, overloading the server or database.",
                  "mitigation": "- Enable DDOS protection on reverse proxy server\n- Enable CAPTCHA\n- Apply rate limiting per user/IP\n- Cache non-sensitive content\n- Monitor and block abnormal request patterns",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 43,
                  "score": ""
                },
                {
                  "id": "00d0d575-30e3-4cf4-874b-93f7eb4aa2b0",
                  "title": "Bypassing Read-Only Restrictions",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Elevation of privilege",
                  "description": "A user with read-only access exploits a flaw to modify the note while viewing it.",
                  "mitigation": "- Enforce permissions at the API and database level\n- Use role-based access control\n- Validate all requests against allowed actions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 46,
                  "score": ""
                },
                {
                  "id": "f2c42f93-6177-4ed8-ab77-ec5d174c6104",
                  "title": "HTTPS downgrade attack",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "Attempt to access site via HTTP\t",
                  "mitigation": "- Enforce HTTPS with HSTS headers\n- Redirect HTTP request to HTTPS",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 47,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 3,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 2,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 610,
              "y": -430
            },
            "size": {
              "width": 170,
              "height": 140
            },
            "attrs": {
              "text": {
                "text": "Login"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 23,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5b041b96-cce6-4f18-9a85-3fa0c3c16f9f"
                },
                {
                  "group": "right",
                  "id": "45877ef0-452c-40f2-95e8-c29668fab3d5"
                },
                {
                  "group": "bottom",
                  "id": "c8232fcc-7821-4f35-b85d-1a777f716dbb"
                },
                {
                  "group": "left",
                  "id": "bf79f26d-616c-4bac-bbc0-817766405c82"
                }
              ]
            },
            "id": "4edad714-ae72-4127-b8d1-54d765a1d367",
            "data": {
              "type": "tm.Process",
              "name": "Login",
              "description": "To access the ShareNote system, a user must perform the login process, which involves entering their registered credentials, such as username and password, into the system’s authentication interface. This action verifies the user’s identity and grants them access to the features and resources available within the platform.\n",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "cb86adcb-918f-432c-ba0c-f159dc9f44b8",
                  "title": "Unauthorized Access to Notes",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Spoofing",
                  "description": "An attacker pretends to be an authorized user (e.g., by using stolen session tokens) to view notes they shouldn’t have access to.",
                  "mitigation": "- Validate session tokens for every request\n- Enforce strict server-side access control\n- Implement Multi-Factor Authentication (MFA) for sensitive accounts",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 95,
                  "score": ""
                },
                {
                  "id": "eb253f73-a879-4c7e-8552-cfd46a3277f8",
                  "title": "Manipulating Request Parameters",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "A user alters parameters (e.g., noteId) in the request to view another user’s note without permission.",
                  "mitigation": "- Perform server-side authorization checks\n- Validate all input against expected formats",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 96,
                  "score": ""
                },
                {
                  "id": "6579db57-6ee5-4a29-b922-a06b9537c66c",
                  "title": "Exposure of Sensitive Information",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "Viewing a note may expose sensitive content to unauthorized parties if access control is flawed or the note is cached in public areas.",
                  "mitigation": "- Enforce strict access checks before returning content\n- Prevent caching of sensitive pages",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 97,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 1300,
              "y": -270
            },
            "size": {
              "width": 210,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "User Datastore"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 24,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "614387b1-a5a6-4341-879f-12831492b807"
                },
                {
                  "group": "right",
                  "id": "b0dcae8e-d0f6-4522-8def-627a139e7299"
                },
                {
                  "group": "bottom",
                  "id": "e3d0aec3-5187-4fe0-a160-cf5ec015aba1"
                },
                {
                  "group": "left",
                  "id": "91903c17-f095-4151-9442-5fd8fb391443"
                }
              ]
            },
            "id": "b1556f56-9688-492a-bbc5-f38c4c83e415",
            "data": {
              "type": "tm.Store",
              "name": "User Datastore",
              "description": "This database contains all user data.\nevery entry contains:\n* userId: String\n* username: String\n* email: String",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "cf205601-5c26-416a-8957-eb1d5cfa309f",
                  "title": "Datastore unwanted access",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "The datastore must be access-protected to only authorised personnel. ",
                  "mitigation": "- Datastore credentials are securely stored on password vaults with limited set of users having access (apply least privilege principle).\n- Datastore credentials are injected into connecting software from secured variables or files (apply least privilege principle).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 99,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 590,
              "y": -641
            },
            "size": {
              "width": 160,
              "height": 180
            },
            "attrs": {
              "text": {
                "text": "Register"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 25,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5b041b96-cce6-4f18-9a85-3fa0c3c16f9f"
                },
                {
                  "group": "right",
                  "id": "45877ef0-452c-40f2-95e8-c29668fab3d5"
                },
                {
                  "group": "bottom",
                  "id": "c8232fcc-7821-4f35-b85d-1a777f716dbb"
                },
                {
                  "group": "left",
                  "id": "bf79f26d-616c-4bac-bbc0-817766405c82"
                }
              ]
            },
            "id": "4cb9ca11-a975-48c9-8cb3-90069ad09959",
            "data": {
              "type": "tm.Process",
              "name": "Register",
              "description": "Action to register a user account to the ShareNote app",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "df0720e9-a838-4f7e-bc08-53742081ab84",
                  "title": "Adversary in the middle attack",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Information disclosure",
                  "description": "A man-in-the-middle could steal the credentials as the user registers.",
                  "mitigation": "* Use secured connection protocol.\n* Ensure IP is consistent for the whole process.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 101,
                  "score": ""
                },
                {
                  "id": "e0dff56c-a540-4497-9204-c3bec18911fb",
                  "title": "User uses an email they don't own",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Repudiation",
                  "description": "The user pretends they have access to an email address they don't own.",
                  "mitigation": "* Ensure the email is not already in use.\n* Send a confirmation email with unique token to confirm email ownership.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 102,
                  "score": ""
                },
                {
                  "id": "54104bcd-3080-4310-98ea-beceab05cba2",
                  "title": "Flooding of requests from same IP",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Denial of service",
                  "description": "Many register request per second coming from the same IP.",
                  "mitigation": "* Enable a CAPTCHA-like feature\n* Disallow multiple requests from same origin IP (IP blocking after multiple calls)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 103,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 0
              }
            }
          }
        ],
        "description": "ShareNote STRIDE diagram"
      }
    ],
    "diagramTop": 1,
    "reviewer": "Xiaoping",
    "threatTop": 121
  }
}